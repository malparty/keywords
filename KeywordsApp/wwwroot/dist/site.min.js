(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=jQuery;var a=e.n(t),r=(new signalR.HubConnectionBuilder).withUrl("/parser").build();r.on("KeywordStatusUpdate",(function(e,t,r,s,o,n){const i=a()("#parsedKeywordsList").data("single-load"),d=a()("#parsedKeywordsListContainer");a().post(i,{keywordId:r},(e=>{const t=d.children().length;0==t?d.html(e):(d.prepend(e),t>=8&&d.children().last().remove()),a()("#parsedKeywordsListContainer div.card").first().effect("highlight",{color:"#78ff96"},1e3)}));const l=a()("#fileCard"+e);l.find(".progress-bar").width(t+"%"),l.find(".progress-bar").html(t+"%")})),r.start().then((function(){a()("#signalRBadge").removeClass("badge-light"),a()("#signalRBadge").addClass("badge-success"),a()("#signalRBadge").attr("title","SignalR connected!")})).catch((function(e){return console.error(e.toString())}));class s{initLoader=()=>{a()("section[data-load-ajax]").map(((e,t)=>{var r=a()(t);r.load(r.data("load-ajax"),((e,t)=>{"error"==t&&(r.html("<b>Error:</b> Could not load component"),r.addClass("text-danger"))}))}))}}a()((function(){(new s).initLoader()}));class o{MAX_UPLOAD_SIZE=1e4;form=a()(".csv-form");initForm=()=>{this.form.change((()=>{const e=this.form.find(".csv-form-error-msg"),t=this.form.find(".csv-form-file-name"),a=this.form.find(".csv-form-file-input"),r=this.form.find(".csv-form-uploaded-msg");if(e.fadeOut(),r.fadeOut(),e.html(""),t.html(""),t.removeClass("text-danger"),a[0].files.length>0){const s=a[0].files[0];s.size>this.MAX_UPLOAD_SIZE?(e.html(`Please select a file under ${this.MAX_UPLOAD_SIZE/1e4}Kb.`),e.fadeIn(250),t.addClass("text-danger")):".csv"!=s.name.match(/\.[0-9a-z]+$/i)[0]?(e.html("Please select a .csv file."),e.fadeIn(250),t.addClass("text-danger")):(r.fadeIn(250),this.submitForm()),t.html(s.name)}}))};submitForm=()=>{const e=new FormData(this.form[0]);a().ajax({type:"POST",enctype:"multipart/form-data",url:this.form.attr("action"),data:e,processData:!1,contentType:!1,cache:!1,timeout:6e5,success:function(e){a()("#uploadFormContainer").html(e);const t=new o;t.initForm();const r=a()("#previousFileId").val();t.loadNewCard(r)},error:function(e){console.log("ERROR : ",e)}})};loadNewCard=e=>{const t=a()("#csvFilesList").data("single-load"),r=a()("#csvFilesListContainer");a().post(t,{fileId:e},(e=>{const t=r.children().length;0==t?r.html(e):(r.prepend(e),t>=8&&r.children().last().remove()),a()("#csvFilesListContainer div.card").first().effect("highlight",{color:"#78ff96"},1e3)}))}}a()((function(){(new o).initForm()}))})();